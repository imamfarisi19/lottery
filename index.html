<!DOCTYPE html>
<html>

<head>
    <style>
        table,
        th,
        td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        
        li {
            border: 1px solid black;
        }
    </style>
    <title>Lottery Farisi</title>
</head>

<body>
    <h1> Aplikasi undian - Farisi </h1>
    <h2>File upload</h2>
    <label for="myfile">Select a file:</label><br/>
    <input type="file" id="fileUpload" name="fileUpload" required/><br/>
    <input type=" text " id="jumlahpemenang" name="jumlahpemenang" required/><br/>
    <input type="submit" value="Submit" onclick="upload()">
    <hr/>

    <table style="width: 100%">
        <tr>
            <th>Nama</th>
            <th>Email</th>
            <th>Nomor WhatsApp</th>
        </tr>
        <tr>
            <td>
                <ol id="name"></ol>
            </td>
            <td>
                <ol id="email"></ol>
            </td>
            <td>
                <ol id="wA"></ol>
            </td>
        </tr>
    </table>
    <script>
        function upload(event) {
            var file = document.getElementById("fileUpload").files[0];
            var reader = new FileReader();
            const limit = document.getElementById("jumlahpemenang").value;

            reader.onload = function(e) {
                console.log(e)
                var ar = e.target.result.split("\n");
                ar.shift();
                let shuffleData = acak(ar);
                let rowData = shuffleData.splice(0, limit);
                rowData.map(row => {
                    console.log(row);
                    const name = row.split(",")[2].split('"')[1];
                    const email = row.split(",")[1].split('"')[1];
                    const wA = row.split(",")[5].split('"')[1];
                    console.log(wA);
                    // Create list element from name
                    let nameList = document.createElement("li");
                    let nameValue = document.createTextNode(name);
                    nameList.appendChild(nameValue);
                    document.getElementById("name").appendChild(nameList);

                    // Create list element from email
                    let emailList = document.createElement("li");
                    let emailValue = document.createTextNode(email);
                    emailList.appendChild(emailValue);
                    document.getElementById("email").appendChild(emailList);

                    // Create list element from email
                    let wAList = document.createElement("li");
                    let wAValue = document.createTextNode(wA);
                    wAList.appendChild(wAValue);
                    document.getElementById("wA").appendChild(wAList);
                })
            };
            reader.readAsText(file);
        }

        function acak(ar) {

            var ctr = ar.length,
                temp, index;

            // while there are elements in the array
            while (ctr > 0) {
                // pick a random index
                index = Math.floor(Math.random() * ctr);
                // Decrease ctr by 1
                ctr--;
                // and swap the last element with it
                temp = ar[ctr];
                ar[ctr] = ar[index];
                ar[index] = temp;
            }
            return ar;
        }
    </script>
    <script>
        //Concept and definition

        //Objects are programming entities that have certain basic characteristics:
        /* 
        Identity: 
        Every object in an object-oriented program has an identity. In other words, 
        every occurrence of a particular type of object —an instance — can be distinguished from
        every other occurrence of the same type of object as well as from objects of other types. 
        */
        /*
        Type: 
        Object-oriented programming lets you assign names to the different kind of objects in a program.
        In Java, classes define types. Therefore, when you create an object from a type, you’re saying 
        that the object is of the type specified by the class. 
        */
        /*
        State: 
        Although each instance of a given object type has the same attributes, each instance has a different
        state: that is, a different combination of values for each of its attributes. 
        */
        /*
        Behavior: 
        Another characteristic of objects is that they have behavior, which means that they can do things. 
        Like state, the specific behavior of an object depends on its type. Unlike state, though, behavior isn’t different 
        foreach instance of a type. 
        */
    </script>
</body>

</html>